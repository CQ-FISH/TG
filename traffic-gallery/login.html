<!DOCTYPE html>
<!--
================================================================================
äº¤é€šå›¾åº“ - ç™»å½•/æ³¨å†Œé¡µé¢ (login.html)
================================================================================

ã€æ–‡ä»¶è¯´æ˜ã€‘
æœ¬æ–‡ä»¶æ˜¯äº¤é€šå›¾åº“ç½‘ç«™çš„ç™»å½•/æ³¨å†Œé¡µé¢ï¼Œä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š

1. ç™»å½•åŠŸèƒ½ï¼šç”¨æˆ·å¯ä»¥ä½¿ç”¨å·²æœ‰è´¦å·ç™»å½•ç³»ç»Ÿ
2. æ³¨å†ŒåŠŸèƒ½ï¼šæ–°ç”¨æˆ·å¯ä»¥æ³¨å†Œæ–°è´¦å·
3. è¡¨å•åˆ‡æ¢ï¼šåœ¨ç™»å½•å’Œæ³¨å†Œè¡¨å•ä¹‹é—´è‡ªç”±åˆ‡æ¢
4. è¡¨å•éªŒè¯ï¼šå®æ—¶éªŒè¯ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯
5. å¯†ç ç¡®è®¤ï¼šæ³¨å†Œæ—¶éªŒè¯ä¸¤æ¬¡å¯†ç è¾“å…¥æ˜¯å¦ä¸€è‡´
6. éªŒè¯ç ï¼šæ³¨å†Œæ—¶éœ€è¦è¾“å…¥éªŒè¯ç 
7. è®°ä½æˆ‘ï¼šç™»å½•æ—¶å¯ä»¥é€‰æ‹©è®°ä½ç™»å½•çŠ¶æ€

ã€é¡µé¢ç»“æ„ã€‘
- å¯¼èˆªæ ï¼šä¸å…¶ä»–é¡µé¢ä¿æŒä¸€è‡´çš„å¯¼èˆªç»“æ„
- é¡µé¢æ ‡é¢˜ï¼šæ˜¾ç¤º"ç”¨æˆ·ç™»å½•/æ³¨å†Œ"æ ‡é¢˜å’Œå‰¯æ ‡é¢˜
- è®¤è¯åŒºåŸŸï¼šåŒ…å«ç™»å½•å’Œæ³¨å†Œä¸¤ä¸ªè¡¨å•
- è¡¨å•åˆ‡æ¢ï¼šç™»å½•å’Œæ³¨å†Œæ ‡ç­¾é¡µåˆ‡æ¢
- ç™»å½•è¡¨å•ï¼šåŒ…å«ç”¨æˆ·åã€å¯†ç ã€è®°ä½æˆ‘é€‰é¡¹
- æ³¨å†Œè¡¨å•ï¼šåŒ…å«ç”¨æˆ·åã€å¯†ç ã€ç¡®è®¤å¯†ç ã€éªŒè¯ç 
- é¡µè„šï¼šåŒ…å«ç½‘ç«™é“¾æ¥ã€ç»Ÿè®¡æ•°æ®å’Œç‰ˆæƒä¿¡æ¯

ã€æŠ€æœ¯ç‰¹ç‚¹ã€‘
- å“åº”å¼è®¾è®¡ï¼Œé€‚é…ä¸åŒå±å¹•å°ºå¯¸
- è¡¨å•åˆ‡æ¢åŠŸèƒ½ï¼Œæ— éœ€é¡µé¢åˆ·æ–°
- å®¢æˆ·ç«¯è¡¨å•éªŒè¯
- æ¨¡æ‹Ÿç™»å½•/æ³¨å†ŒéªŒè¯æµç¨‹
- ç™»å½•æˆåŠŸåè‡ªåŠ¨è·³è½¬åˆ°é¦–é¡µ
- æ³¨å†ŒæˆåŠŸåè‡ªåŠ¨åˆ‡æ¢åˆ°ç™»å½•è¡¨å•

ã€ä¾èµ–æ–‡ä»¶ã€‘
- CSSæ–‡ä»¶ï¼šcss/global.css, css/layout.css
- JSæ–‡ä»¶ï¼šjs/config.js, js/data.js, js/main.js

ã€ä½œè€…ã€‘AI Assistant
ã€æ—¥æœŸã€‘2026-02-21
ã€ç‰ˆæœ¬ã€‘v1.0.0
================================================================================
-->
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç™»å½•/æ³¨å†Œ - äº¤é€šå›¾åº“</title>
  <meta name="description" content="äº¤é€šå›¾åº“ç”¨æˆ·ç™»å½•å’Œæ³¨å†Œé¡µé¢ï¼Œç”¨æˆ·å¯ä»¥ç™»å½•å·²æœ‰è´¦å·æˆ–æ³¨å†Œæ–°è´¦å·ã€‚">
  <!-- å…¨å±€æ ·å¼ -->
  <link rel="stylesheet" href="css/global.css">
  <link rel="stylesheet" href="css/layout.css">
  <!-- æ ¸å¿ƒJSæ–‡ä»¶ -->
  <script src="js/config.js"></script>
  <script src="js/database.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/main.js"></script>
</head>
<body>
  <!-- å¯¼èˆªæ  -->
  <nav class="navbar">
    <div class="navbar-container">
      <!-- å“ç‰Œæ ‡è¯† -->
      <a href="index.html" class="navbar-brand">
        <span class="navbar-brand-icon">ğŸš—</span>
        <span>äº¤é€šå›¾åº“</span>
      </a>
      
      <!-- ä¸»å¯¼èˆª -->
      <ul class="navbar-nav">
        <li class="nav-item">
          <a href="index.html" class="nav-link">é¦–é¡µ</a>
        </li>
        <li class="nav-item dropdown">
          <a href="#" class="nav-link">åˆ†ç±»</a>
          <div class="dropdown-menu" id="nav-category-dropdown"></div>
        </li>
        <li class="nav-item">
          <a href="gallery.html" class="nav-link">å‘ç°</a>
        </li>
        <li class="nav-item">
          <a href="upload.html" class="nav-link">ä¸Šä¼ </a>
        </li>
        <li class="nav-item" id="login-register-link">
          <a href="login.html" class="nav-link">ç™»å½•/æ³¨å†Œ</a>
        </li>
        <li class="nav-item dropdown user-dropdown" id="user-dropdown" style="display: none;">
          <div class="user-avatar" id="user-avatar">
            <span id="username-display"></span>
          </div>
          <div class="dropdown-menu">
            <a href="profile.html" class="dropdown-item">ä¸ªäººä¿¡æ¯</a>
            <a href="#" class="dropdown-item" onclick="logout()">é€€å‡ºç™»å½•</a>
          </div>
        </li>
      </ul>
      
      <!-- æœç´¢æ¡† -->
      <div class="search-container">
        <input type="text" id="global-search-input" class="search-input" placeholder="æœç´¢ä½œå“ã€æ‘„å½±å¸ˆ...">
        <button type="button" id="global-search-btn" class="search-btn">æœç´¢</button>
      </div>
    </div>
  </nav>

  <!-- é¡µé¢å†…å®¹ -->
  <main class="content">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <section class="page-header">
      <div class="container">
        <h1 class="page-title">ç”¨æˆ·ç™»å½•/æ³¨å†Œ</h1>
        <p class="page-subtitle">ç™»å½•å·²æœ‰è´¦å·æˆ–æ³¨å†Œæ–°è´¦å·ï¼Œäº«å—æ›´å¤šåŠŸèƒ½</p>
      </div>
    </section>

    <!-- ç™»å½•/æ³¨å†Œè¡¨å• -->
    <section class="auth-section">
      <div class="container">
        <div class="row" style="display: flex; justify-content: center;">
          <div class="col-md-6">
            <!-- åˆ‡æ¢æŒ‰é’® -->
            <div class="auth-tabs" style="display: flex; margin-bottom: 2rem; border-bottom: 1px solid #ddd;">
              <button type="button" id="login-tab" class="auth-tab active" style="flex: 1; padding: 1rem; background: none; border: none; border-bottom: 2px solid #3498db; font-size: 1.1rem; font-weight: 500; cursor: pointer;">ç™»å½•</button>
              <button type="button" id="register-tab" class="auth-tab" style="flex: 1; padding: 1rem; background: none; border: none; border-bottom: 2px solid transparent; font-size: 1.1rem; font-weight: 500; cursor: pointer;">æ³¨å†Œ</button>
            </div>

            <!-- ç™»å½•è¡¨å• -->
            <div id="login-form-container">
              <form id="login-form">
                <div class="form-group">
                  <label for="login-username" class="form-label">ç”¨æˆ·å <span class="text-danger">*</span></label>
                  <input type="text" id="login-username" class="form-control" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" required>
                </div>
                <div class="form-group">
                  <label for="login-password" class="form-label">å¯†ç  <span class="text-danger">*</span></label>
                  <input type="password" id="login-password" class="form-control" placeholder="è¯·è¾“å…¥å¯†ç " required>
                </div>
                <div class="form-group">
                  <label for="login-secret-key" class="form-label">ç»‘å®šå¯†é’¥ <span class="text-danger">*</span></label>
                  <input type="text" id="login-secret-key" class="form-control" placeholder="è¯·è¾“å…¥ç»‘å®šå¯†é’¥" required>
                  <small class="form-text text-muted">å¯†é’¥åœ¨æ³¨å†Œæ—¶ç”Ÿæˆï¼Œè¯·å¦¥å–„ä¿ç®¡</small>
                </div>
                <div class="form-group">
                  <div class="form-check">
                    <input type="checkbox" id="remember-me" class="form-check-input">
                    <label for="remember-me" class="form-check-label">è®°ä½æˆ‘</label>
                  </div>
                </div>
                <div class="form-actions">
                  <button type="submit" class="btn btn-primary">ç™»å½•</button>
                </div>
              </form>
            </div>

            <!-- æ³¨å†Œè¡¨å• -->
            <div id="register-form-container" style="display: none;">
              <form id="register-form">
                <div class="form-group">
                  <label for="register-username" class="form-label">ç”¨æˆ·å <span class="text-danger">*</span></label>
                  <input type="text" id="register-username" class="form-control" placeholder="è¯·è¾“å…¥ç”¨æˆ·åï¼ˆ3-20ä¸ªå­—ç¬¦ï¼‰" required>
                </div>
                <div class="form-group">
                  <label for="register-password" class="form-label">å¯†ç  <span class="text-danger">*</span></label>
                  <input type="password" id="register-password" class="form-control" placeholder="è¯·è¾“å…¥å¯†ç ï¼ˆ6-20ä¸ªå­—ç¬¦ï¼‰" required>
                </div>
                <div class="form-group">
                  <label for="register-confirm-password" class="form-label">ç¡®è®¤å¯†ç  <span class="text-danger">*</span></label>
                  <input type="password" id="register-confirm-password" class="form-control" placeholder="è¯·ç¡®è®¤å¯†ç " required>
                </div>
                <div class="form-group">
                  <label for="register-captcha" class="form-label">éªŒè¯ç  <span class="text-danger">*</span></label>
                  <div class="row">
                    <div class="col-md-6">
                      <input type="text" id="register-captcha" class="form-control" placeholder="è¯·è¾“å…¥éªŒè¯ç " required>
                    </div>
                    <div class="col-md-6">
                      <div class="captcha-image" style="background-color: #f8f9fa; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 1.2rem; font-weight: bold; letter-spacing: 0.25rem;">1A2B3C</div>
                    </div>
                  </div>
                </div>
                <!-- æ³¨å†ŒæˆåŠŸåæ˜¾ç¤ºå¯†é’¥çš„åŒºåŸŸ -->
                <div id="register-secret-key-display" class="form-group" style="display: none;">
                  <div class="alert alert-success" style="background-color: #d4edda; border: 1px solid #c3e6cb; color: #155724; padding: 15px; border-radius: 4px;">
                    <h4 style="margin-top: 0; color: #155724;">ğŸ‰ æ³¨å†ŒæˆåŠŸï¼</h4>
                    <p style="margin-bottom: 10px;">è¯·å¦¥å–„ä¿ç®¡æ‚¨çš„ç»‘å®šå¯†é’¥ï¼Œè¿™æ˜¯ç™»å½•çš„å¿…è¦å‡­è¯ï¼š</p>
                    <div style="background-color: #fff; padding: 10px; border-radius: 4px; font-family: monospace; font-size: 1.1rem; text-align: center; letter-spacing: 2px; margin: 10px 0;">
                      <strong id="generated-secret-key"></strong>
                    </div>
                    <p style="font-size: 0.9rem; margin-bottom: 0;">âš ï¸ å¯†é’¥ä»…æ˜¾ç¤ºä¸€æ¬¡ï¼Œè¯·ç«‹å³å¤åˆ¶ä¿å­˜ï¼</p>
                  </div>
                </div>
                <div class="form-actions">
                  <button type="submit" class="btn btn-primary" id="register-submit-btn">æ³¨å†Œ</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- é¡µè„š -->
  <footer class="footer">
    <div class="footer-container">
      <div class="footer-row">
        <div class="footer-col">
          <h3>å…³äºæˆ‘ä»¬</h3>
          <ul class="footer-links">
            <li><a href="about.html">å…³äºäº¤é€šå›¾åº“</a></li>
            <li><a href="about.html#rules">ä½¿ç”¨è§„åˆ™</a></li>
            <li><a href="about.html#contact">è”ç³»æˆ‘ä»¬</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h3>å¿«é€Ÿé“¾æ¥</h3>
          <ul class="footer-links">
            <li><a href="gallery.html">æœ€æ–°ä½œå“</a></li>
            <li><a href="gallery.html?sort=popular">çƒ­é—¨ä½œå“</a></li>
            <li><a href="upload.html">ä¸Šä¼ ä½œå“</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h3>å¸®åŠ©ä¸­å¿ƒ</h3>
          <ul class="footer-links">
            <li><a href="faq.html">å¸¸è§é—®é¢˜</a></li>
            <li><a href="bug.html">æäº¤BUG</a></li>
            <li><a href="bug-list.html">BUGåˆ—è¡¨</a></li>
          </ul>
        </div>
      </div>
      
      <!-- ç»Ÿè®¡ä¿¡æ¯ -->
      <div class="footer-stats">
        <div class="footer-stats-item">
          <span class="footer-stats-number" id="online-users"></span>
          <span class="footer-stats-label">åœ¨çº¿äººæ•°</span>
        </div>
        <div class="footer-stats-item">
          <span class="footer-stats-number" id="total-visits"></span>
          <span class="footer-stats-label">ç´¯è®¡è®¿é—®</span>
        </div>
        <div class="footer-stats-item">
          <span class="footer-stats-number" id="registered-users"></span>
          <span class="footer-stats-label">æ³¨å†Œç”¨æˆ·</span>
        </div>
        <div class="footer-stats-item">
          <span class="footer-stats-number" id="today-visits"></span>
          <span class="footer-stats-label">ä»Šæ—¥è®¿é—®</span>
        </div>
      </div>
      
      <!-- ç‰ˆæƒä¿¡æ¯ -->
      <div class="footer-bottom">
        <p>&copy; 2026 äº¤é€šå›¾åº“ - å…¨å“ç±»äº¤é€šæ‘„å½±ä½œå“åˆ†äº«å¹³å° | ç‰ˆæœ¬ v1.0.0</p>
      </div>
    </div>
  </footer>

  <!-- è¿”å›é¡¶éƒ¨æŒ‰é’® -->
  <div class="back-to-top" id="back-to-top">â†‘</div>

  <!-- ç™»å½•/æ³¨å†Œè„šæœ¬ -->
  <script>
    // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
    document.addEventListener('DOMContentLoaded', function() {
      // ç»‘å®šæ ‡ç­¾åˆ‡æ¢äº‹ä»¶
      bindTabEvents();
      // ç»‘å®šç™»å½•è¡¨å•äº‹ä»¶
      bindLoginFormEvent();
      // ç»‘å®šæ³¨å†Œè¡¨å•äº‹ä»¶
      bindRegisterFormEvent();
    });

    // ç»‘å®šæ ‡ç­¾åˆ‡æ¢äº‹ä»¶
    function bindTabEvents() {
      const loginTab = document.getElementById('login-tab');
      const registerTab = document.getElementById('register-tab');
      const loginFormContainer = document.getElementById('login-form-container');
      const registerFormContainer = document.getElementById('register-form-container');

      loginTab.addEventListener('click', function() {
        loginTab.classList.add('active');
        registerTab.classList.remove('active');
        loginFormContainer.style.display = 'block';
        registerFormContainer.style.display = 'none';
      });

      registerTab.addEventListener('click', function() {
        registerTab.classList.add('active');
        loginTab.classList.remove('active');
        registerFormContainer.style.display = 'block';
        loginFormContainer.style.display = 'none';
      });
    }

    // ç»‘å®šç™»å½•è¡¨å•äº‹ä»¶
    function bindLoginFormEvent() {
      const loginForm = document.getElementById('login-form');
      loginForm.addEventListener('submit', function(event) {
        event.preventDefault();

        const username = document.getElementById('login-username').value.trim();
        const password = document.getElementById('login-password').value;
        const secretKey = document.getElementById('login-secret-key').value.trim();

        // ä½¿ç”¨æ–°çš„å¯†é’¥éªŒè¯æœºåˆ¶ç™»å½•
        const result = userLoginWithSecretKey(username, password, secretKey);
        
        if (result.success) {
          alert('ç™»å½•æˆåŠŸï¼æ¬¢è¿å›æ¥ï¼Œ' + username);
          window.location.href = 'index.html';
        } else {
          alert('ç™»å½•å¤±è´¥ï¼š' + result.message);
        }
      });
    }

    // ç»‘å®šæ³¨å†Œè¡¨å•äº‹ä»¶
    function bindRegisterFormEvent() {
      const registerForm = document.getElementById('register-form');
      registerForm.addEventListener('submit', function(event) {
        event.preventDefault();

        const username = document.getElementById('register-username').value.trim();
        const password = document.getElementById('register-password').value;
        const confirmPassword = document.getElementById('register-confirm-password').value;
        const captcha = document.getElementById('register-captcha').value.trim();

        // éªŒè¯éªŒè¯ç 
        if (captcha !== '1A2B3C') {
          alert('éªŒè¯ç é”™è¯¯');
          return;
        }

        // ä½¿ç”¨æ–°çš„å¯†é’¥ç»‘å®šæœºåˆ¶æ³¨å†Œ
        const result = userRegisterWithSecretKey(username, password, confirmPassword);
        
        if (result.success) {
          // æ˜¾ç¤ºå¯†é’¥
          document.getElementById('generated-secret-key').textContent = result.secretKey;
          document.getElementById('register-secret-key-display').style.display = 'block';
          document.getElementById('register-submit-btn').style.display = 'none';
          
          // 3ç§’åè‡ªåŠ¨åˆ‡æ¢åˆ°ç™»å½•é¡µ
          setTimeout(function() {
            if (confirm('æ˜¯å¦ç«‹å³è·³è½¬åˆ°ç™»å½•é¡µé¢ï¼Ÿ')) {
              document.getElementById('login-tab').click();
              document.getElementById('login-username').value = username;
              // é‡ç½®æ³¨å†Œè¡¨å•
              document.getElementById('register-secret-key-display').style.display = 'none';
              document.getElementById('register-submit-btn').style.display = 'block';
              registerForm.reset();
            }
          }, 3000);
        } else {
          alert('æ³¨å†Œå¤±è´¥ï¼š' + result.message);
        }
      });
    }
  </script>
</body>
</html>
